# Bridge

## Bridgeパターン
Bridgeパターンが橋渡しをしている2つの場所は、  
「機能のクラス階層」と「実装のクラス階層」  
である。  

## クラス階層の2つの役割
### 新しい「機能」を追加したいときには・・・
機能を追加するために作られた階層
* スーパークラスは基本的な機能を持っている
* サブクラスで新しい機能を追加する

このクラス階層を  
**機能のクラス階層**  
と呼ぶことにする

### 新しい「実装」を追加したいときには・・・
次のような役割分担のためにクラス階層が使われている
* スーパークラスは抽象メソッドによってインターフェース(API)を規定している
* サブクラスは具象メソッドによってそのインターフェース(API)を実装する

このクラス階層を  
**実装のクラス階層**  
と呼ぶことにする  

### クラス階層の混在とクラス階層の分離
「機能のクラス階層」と「実装のクラス階層」を2つの独立したクラス階層に分ける。単に分けただけではバランバラになってしまうので、その2つのクラス階層の間に橋渡しをすることが必要。

## サンプルプログラム

### 機能のクラス階層 : `AbstractShape` -> `Rectangle` & `Cirlce`
`applyColor()`という機能を実現するために、Colorインターフェースを実装した、実装階層の具象クラス`Blue`&`Red`を委譲して用いる。  

### 実装の階層 : `Color` ..> `Blue` & `Red`
Shape達の機能を実現するための実装  

## Sample Code Running

```
$ cd src
$ javac bridge/Main.java
$ java bridge.Main
Rectangle is now colored with
Blue
Circle is now colored with
Red
```

## Bridgeパターンの登場人物
### Abstraction(抽象化)の役
「機能のクラス階層」の最上位のクラス。Implementor役のメソッドを使って基本的な機能だけが記述されているクラス。このインスタンスは、Implementor役を保持する。サンプルプログラムでは、`AbstractShape`がこの役をつとめた。  

### RefinedAbstraction(改善した抽象化)の役
Abstraction役に対して機能を追加した役。サンプルプログラムでは、`Rectangle`, `Circle`がこの役をつとめた。  

### Implementor(実装者)の役
「実装クラス階層」の最上位。Abstraction役のインターフェース(API)を実装するためのメソッドを規定する役。サンプルプログラムでは、`Color`がこの役をつとめた。  

### ConcreteImplementor(具体的な実装者)の役
サンプルプログラムでは、`Red`, `Blue`がこの役をつとめた。  


## 考えを広げるためのヒント
### 分けておけば、拡張するのが楽になる
Bridgeパターンの特徴は、「機能のクラス階層」と「実装のクラス階層」を分けている点にある。この2つのクラス階層を分けておけば、それぞれのクラス階層を独立に拡張することができる。  
機能を追加したければ、機能のクラス階層にクラスに追加する。このとき、実装のクラス階層はまったく修正する必要はない。さらに、**いま追加した機能は「すべての実装」で利用できることになる**。  

例えば、実装のクラス階層をOSに当てはめて考える。あるプログラムにOSに依存の部分があり、Windows版、Macintosh版、LINUX版に分かれているとする。そのOS依存の部分をBridgeパターンの「実装のクラス階層」で表現する。つまり、各OS共通のインターフェース(API)を決めてImplementor役とし、ConcreteImplementor役として、Windows版、Macintosh版、LINUX版の3つのクラスを作る。こうしておけば、「機能のクラス階層」側でいくら機能を追加しても、3つのOSに同時に対応していることになる。  

### 継承は固い結びつき、委譲はゆるやかな結びつき
もしも、ConcreteImplementor役が他にもあったとして、そのインスタンスを`Rectangle`, `Circle`に渡したなら、それで実装がかちりと切り替わったことになる。この切り替えを行うときに修正したのはMainクラスだけである。他のソースコードは全くいじる必要がない。  
継承は固い結びつきであり、委譲はゆるやかな結びつきである。複数のクラス設計を行うときには、このことを理解しておく必要がある。

## 関連しているパターン
### Template Methodパターン
実装のクラス階層を利用する。

### Abstract Factoryパターン
Bridgeパターンに登場するConcreteImplementor役を環境に合わせて適切に構築するために、Abstract Factoryパターンが用いられる場合がある。  
